<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>KeyPaws</title>
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <button class="close" id="welcome-close"><span class="screen-reader-text">close window</span></button>
  <div class="drag-bar"></div>
  <div id="theme-wrapper"></div>
  <main class="container">
    <pre class="kitcat">
 /\___/\
(  o o  )
(  =^=  )
(        )
(         )
(          )____Â£$tr2frfgre?
</pre>
    <section id="welcome">

      <h1>Setup KeyPaws</h1>
      <article class="step" data-panel="panel-0">
        <div class="welcome-grid">
          <header>
            <h2>Thanks for installing</h2>
            <p>For KeyPaws to run, you need to grant the app permission to access your keyboard.</p>
            <button class="stepper" id="begin-setup">Let's do this</button>
          </header>
          <div class="security-reassure">
            <h2>Don't worry</h2>
            <p>Keypaws checks what's being typed every second and decides whether it's a cat or a human. It then
              instantly
              forgets what you typed. Nothing is sent over the network.</p>
          </div>
        </div>

      </article>
      <article class="step hidden" data-panel="panel-1">
        <div class="welcome-grid grid-img">
          <header>
            <h2>Grant KeyPaws permission</h2>
            <p>Please add KeyPaws to your accessibility settings.</p>
            <button class="welcome-action" id="grant-permission">Open settings</button>
          </header>
          <img src="assets/accessibility-permission.png"
            alt="KeyPaws app with a tick next to it inside Settings > Security & Privacy > Accessibility" />
        </div>
      </article>

      <article class="step hidden" data-panel="panel-2">
        <div class="welcome-grid">
          
          <header>
            <h2>Launch KeyPaws!</h2>
            <p>Once you've granted KeyPaws access to your keyboard, you can go ahead and launch the app:</p>

            <button class="welcome-action" id="confirm-permission">Launch the app</button>
          </header>
          <article id="auto-launch"></article>
          <article id="add-license"></article>
        </div>
      </article>

    </section>
  </main>
</body>


<script src="./themes/nyan.js"></script>
<script src="./widgets/theme-switcher.js"></script>
<script src="./widgets/add-license.js"></script>
<script src="./widgets/auto-launch.js"></script>
<script src="./loading.js"></script>
<script src="./kitty.js"></script>
<script src="./close-icon.js"></script>

<script>
  function renderPanel(slide) {
    let panels = document.querySelectorAll(".step")
    panels.forEach(panel => {
      panel.classList.add("hidden")
    })
    let visiblePanel = document.querySelector(`.step[data-panel="panel-${slide}"]`)
    visiblePanel.classList.remove("hidden")
  }

  renderPanel(0)

  const beginSetupButton = document.querySelector("#begin-setup")
  beginSetupButton.addEventListener("click", () => renderPanel(1))

  const grantPermissionButton = document.querySelector("#grant-permission")
  grantPermissionButton.addEventListener("click", grantPermission)
  const confirmPermissionButton = document.querySelector("#confirm-permission")
  confirmPermissionButton.addEventListener("click", confirmPermission)

  const {
    triggerAccessibilityPermission,
    triggerAccessibilityPermissionGranted,
  } = require("./runner.js")

  function grantPermission() {
    renderPanel(2)
    triggerAccessibilityPermission()
  }
  function confirmPermission() {
    triggerAccessibilityPermissionGranted()
  }
</script>

</html>